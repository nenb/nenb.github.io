
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

<meta property="og:title" content="Trade-offs" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="blog/sqlite_integer_encoding.html" />
  
<meta property="og:description" content="( A short summary of some experimentation, inspired by Simon Willisonâ€™s TIL) Variable-Length Integer Encoding: I often find myself drawn to content discussing trade-off decisions behind some progra..." />
  
<meta property="og:image" content="nenb.github.io/_static/profile.jpg" />
  
<meta property="og:image:alt" content="Trade-offs" />
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'blog/sqlite_integer_encoding';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en"> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/atom.xml"
  title="Nick Byrne's Blog"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search ..." aria-label="Search ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">Nick Byrne</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search ..." aria-label="Search ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
      </div>
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/nenb/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/_nenb" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://mastodon.top/@nenb" title="Mastodon" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-mastodon"></i></span>
            <label class="sr-only">Mastodon</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search ..." aria-label="Search ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
      </div>
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/nenb/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/_nenb" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://mastodon.top/@nenb" title="Mastodon" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-mastodon"></i></span>
            <label class="sr-only">Mastodon</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><div class="profile-pic"><img src="../_static/profile.png" /></div>

<div class="bio-info">
    <div class="name">
    </div>
    <div class="focusareas">
    </div>
</div>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            


            <article class="bd-article" role="main">
               <section id="trade-offs">
<h1>Trade-offs<a class="headerlink" href="#trade-offs" title="Permalink to this heading">#</a></h1>
<p>(<em>A short summary of some experimentation, inspired by Simon Willisonâ€™s <a class="reference external" href="https://github.com/simonw/til">TIL</a></em>)</p>
<section id="variable-length-integer-encoding">
<h2>Variable-Length Integer Encoding<a class="headerlink" href="#variable-length-integer-encoding" title="Permalink to this heading">#</a></h2>
<p>I often find myself drawn to content discussing trade-off decisions behind some program design. Recently Iâ€™ve been reading about the decisions behind the Apache Arrow Flight framework, and behind the file format for <code class="docutils literal notranslate"><span class="pre">sqlite</span></code>.</p>
<p>What I found interesting about Flight is that it offers the possibility of almost no serialization costs - data is sent directly over the wire in the native Arrow format, and itâ€™s only the (comparatively small) metadata that is serialized via the Protocol Buffer format. There is a trade-off here between increased network costs and reduced CPU costs.</p>
<p>Protocol Buffers were actually designed with the opposite trade-offs in mind. They use a variable-length integer (or â€˜varintâ€™) encoding for integers. This results in less data to transfer over the network, but at the cost of extra CPU work at both ends of the network connection. Interestingly, this decision was reversed for the Capâ€™n Proto format (a successor to the Protocol Buffer format), as the author considered the trade-off to no longer be <a class="reference external" href="https://stackoverflow.com/a/24642169">desirable</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">sqlite</span></code> uses a similar varint encoding for its own file format. <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> is widely used in embedded devices and in the â€˜Internet of Thingsâ€™ and so reduced storage costs are also an important consideration in this design decision. However, most of my projects with <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> donâ€™t take place on systems where storage is at such a premium, and I was interested in getting a quick idea about what sort of trade-offs might actually be involved for my own use-cases.</p>
<p><strong>Warning: What follows is a brief and naive analysis of varint encoding costs in <code class="docutils literal notranslate"><span class="pre">sqlite</span></code>. Please take it with a healthy pinch of salt!</strong></p>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h2>
<p>The first step was to decide on some data and a couple of test cases for profiling. In the interests of time, I decided to adopt a variation of some old material from the <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> <a class="reference external" href="https://www.sqlite.org/speed.html">website</a>.</p>
<section id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h3>
<p>In my adaptation there were 2 tables, each with ten million rows:</p>
<p><strong>Table 1</strong></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>RowId</p></th>
<th class="head"><p>RandomInteger</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>253</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p>â€¦</p></td>
<td><p>â€¦</p></td>
</tr>
</tbody>
</table>
<p><strong>Table 2</strong></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>RowId</p></th>
<th class="head"><p>RandomInteger</p></th>
<th class="head"><p>RandomWord</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>253</p></td>
<td><p>â€˜squalidâ€™</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>7</p></td>
<td><p>â€˜daysâ€™</p></td>
</tr>
<tr class="row-even"><td><p>â€¦</p></td>
<td><p>â€¦</p></td>
<td><p>â€¦</p></td>
</tr>
</tbody>
</table>
<p>Most real-world data is not uniformly distributed and so I selected my random integers according to the following empirical distribution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">byte</span> <span class="n">integer</span> <span class="o">~</span> <span class="mi">90</span><span class="o">%</span> <span class="n">of</span> <span class="n">values</span>
<span class="mi">2</span> <span class="n">byte</span> <span class="n">integer</span> <span class="o">~</span> <span class="mi">5</span><span class="o">%</span> <span class="n">of</span> <span class="n">values</span>
<span class="mi">3</span> <span class="n">byte</span> <span class="n">integer</span> <span class="o">~</span> <span class="mi">3</span><span class="o">%</span> <span class="n">of</span> <span class="n">values</span>
<span class="mi">4</span> <span class="n">byte</span> <span class="n">integer</span> <span class="o">~</span> <span class="mi">1</span><span class="o">%</span> <span class="n">of</span> <span class="n">values</span>
<span class="mi">6</span> <span class="n">byte</span> <span class="n">integer</span> <span class="o">~</span> <span class="mf">0.75</span><span class="o">%</span> <span class="n">of</span> <span class="n">values</span>
<span class="mi">8</span> <span class="n">byte</span> <span class="n">integer</span> <span class="o">~</span> <span class="mf">0.25</span><span class="o">%</span> <span class="n">of</span> <span class="n">values</span>
</pre></div>
</div>
<p>For the data in Table 2, I selected 1000 random words from <code class="docutils literal notranslate"><span class="pre">/usr/share/dict/words</span></code> and then sampled from them uniformly.</p>
</section>
<section id="test-cases">
<h3>Test cases<a class="headerlink" href="#test-cases" title="Permalink to this heading">#</a></h3>
<p>I had six test cases. Test cases 1 - 4 involved reading from disk and closely followed the test cases outlined on the <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> website (but note that I have chosen a somewhat arbitrary cut-off value in test case 3):</p>
<ul class="simple">
<li><p><strong>test case 1:</strong> <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">count(*),avg(RandomInteger)</span> <span class="pre">FROM</span> <span class="pre">table1;</span></code></p></li>
<li><p><strong>test case 2:</strong> <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">count(*),avg(RandomInteger)</span> <span class="pre">FROM</span> <span class="pre">table2;</span></code></p></li>
<li><p><strong>test case 3:</strong> <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">count(*),avg(RandomInteger)</span> <span class="pre">FROM</span> <span class="pre">table2</span> <span class="pre">WHERE</span> <span class="pre">RandomInteger&gt;68;</span></code></p></li>
<li><p><strong>test case 4:</strong> <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">count(*),avg(RandomInteger)</span> <span class="pre">FROM</span> <span class="pre">table2</span> <span class="pre">WHERE</span> <span class="pre">RandomWord</span> <span class="pre">LIKE</span> <span class="pre">'squalid';</span></code></p></li>
</ul>
<p>Test cases 5 - 6 involved reading and writing to disk. They were a mix of the test cases on the <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> website, and a personal desire to also import the data from pre-populated CSV files (which is a pattern that still occurs quite frequently for me):</p>
<ul class="simple">
<li><p><strong>test case 5:</strong> <code class="docutils literal notranslate"><span class="pre">.import</span> <span class="pre">table1.csv</span> <span class="pre">table1</span> <span class="pre">--csv</span></code></p></li>
<li><p><strong>test case 6:</strong> <code class="docutils literal notranslate"><span class="pre">.import</span> <span class="pre">table2.csv</span> <span class="pre">table2</span> <span class="pre">--csv</span></code></p></li>
</ul>
<p>Both of these cases were run after initially creating the schema in the relevant database file (e.g. <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span> <span class="pre">table1</span> <span class="pre">(&quot;RandomInteger&quot;</span> <span class="pre">INTEGER,</span> <span class="pre">&quot;RandomWord&quot;</span> <span class="pre">TEXT);</span></code>) and are assuming that the <code class="docutils literal notranslate"><span class="pre">.import</span></code> command has been optimised by the <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> developers for importing efficiently from CSV files.</p>
</section>
<section id="tools">
<h3>Tools<a class="headerlink" href="#tools" title="Permalink to this heading">#</a></h3>
<p>My personal machine is Linux-based and I used <code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">perf</span></code> and the <a class="reference external" href="https://github.com/brendangregg/FlameGraph">Flamegraph Visualiser</a> for the analysis. There was a version of <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> available from the <code class="docutils literal notranslate"><span class="pre">apt</span></code> package manager and I also started with this. Unfortunately, I soon discovered that this binary had had its symbol table stripped (<code class="docutils literal notranslate"><span class="pre">objdump</span> <span class="pre">--syms</span></code>) and was of limited use for my analysis with <code class="docutils literal notranslate"><span class="pre">perf</span></code>. So instead, I pulled the latest version of <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> and built it on my local machine. After some brief experimentation, I settled on the following for gathering a profile of my test cases: <code class="docutils literal notranslate"><span class="pre">perf</span> <span class="pre">record</span> <span class="pre">-F</span> <span class="pre">9999</span> <span class="pre">--call-graph</span> <span class="pre">dwarf</span> <span class="pre">-o</span> <span class="pre">perf.data</span> <span class="pre">bash</span> <span class="pre">&lt;MY_BASH_SCRIPT&gt;</span></code>.</p>
<p>(<em>Note: Unprivileged users made need to play with the <code class="docutils literal notranslate"><span class="pre">perf_event_paranoid</span></code> setting if possible.</em>)</p>
</section>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this heading">#</a></h2>
<p>What quickly became apparent was that reading from disk into the <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> page cache was a non-negligible cost. On reflection, I think that this was to be expected. I have split the results into those with a cold cache and those with a warm cache to account for this cost. I used the <code class="docutils literal notranslate"><span class="pre">sync</span></code> command along with writing to <code class="docutils literal notranslate"><span class="pre">/proc/sys/vm/drop_caches</span></code> to clear the system cache in between test runs.</p>
<p>An implementation detail of <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> that is relevant to the results is that when data is moved to the page cache, it is not decoded - it remains in its original disk format (see the <code class="docutils literal notranslate"><span class="pre">xRead()</span></code> method for further details). This means that even though the warm cache results take less time, they still include the costs of decoding the varints.</p>
<section id="test-cases-1-4">
<h3>Test cases 1 - 4<a class="headerlink" href="#test-cases-1-4" title="Permalink to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Test Case</p></th>
<th class="head"><p>Cold</p></th>
<th class="head"><p>Warm</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>(0.7,0.8)</p></td>
<td><p>(0.5, 0.55)</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>(0.9,1.0)</p></td>
<td><p>(0.65, 0.7)</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>(0.65, 0.8)</p></td>
<td><p>(0.6, 0.65)</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>(0.7, 0.75)</p></td>
<td><p>(0.5, 0.55)</p></td>
</tr>
<tr class="row-even"><td><p>[<em>5% and 95% confidence intervals (seconds)</em>]</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>All of the profiles shared a similar overall appearance and so Iâ€™ve only included two profiles to highlight the most important details.</p>
<a class="reference internal image-reference" href="../_images/tradeoffs_test_case2.png"><img alt="test case 2" src="../_images/tradeoffs_test_case2.png" style="width: 900px;" /></a>
<p><em>Test Case 2 Profile - Cold</em></p>
<!---
<img src="../images/tradeoffs_test_case3.svg">

sqlite3VdbeSerialGet IS WHAT IS USED FOR DECODING!
BUT THEN COMPLICATED BY HAVING TO DETERMINE THE SIZE OF EACH CELL AND SHIFT THE POINTER. TEXT IS PART OF THIS WHICH COMPLICATES THINGS. BUT IN T2 ITS FAIRLY STRAIGHTFORWARD.
sqlite3BtreePayloadSize and sqlite3VdbeSerialGet



### Test cases 5 - 6

## Final thoughts

There are three primary performance factors for a variable-length integer encoding:
- Compression ratio (for the relevant distribution of integers)
- Decoding speed.
- Encoding speed.



 "While SQLite is a general-purpose database engine, it is primarily designed for fast online transaction processing (OLTP)."

 - BRIEF COMPARISON AGAINST UNCOMPRESSED PARQUET FOR ON DISK SIZE
- MENTION THAT COMPRESSION IMPORTANT FOR EMBEDDED APPLICATIONS

-->
</section>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
     
    <a href="fragile_tests.html">
      <i class="fa fa-arrow-circle-left"></i> Fragile Tests
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
    
  </span>
</div>
  
</div>

            </article>
            



<script src="https://giscus.app/client.js"
        data-repo="nenb/nenb.github.io"
        data-repo-id="R_kgDOI8t5Fw"
        data-category="Blog comments"
        data-category-id="DIC_kwDOI8t5F84CUKjn"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>




            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>